{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport dataService from '../services/dataService';\nimport VueDatePicker from '@vuepic/vue-datepicker';\nimport parserMixin from '@/mixins/mixin';\nexport default {\n  data() {\n    return {\n      btnEnabled: false,\n      profile: {},\n      ownerId: '',\n      changedPassword: {\n        oldPassword: '',\n        newPassword: '',\n        newPasswordRepeat: ''\n      },\n      messages: {\n        errorUsername: '',\n        errorFirstName: '',\n        errorLastName: '',\n        errorAdresa: '',\n        errorOldPass: '',\n        errorNewPass: '',\n        errorRepNewPass: '',\n        errorNotEqualOldPassword: '',\n        errorNotEqualNewPassword: '',\n        errorResponse: '',\n        successResponse: ''\n      },\n      userObj: {}\n    };\n  },\n  created() {\n    parserMixin.methods.checkLoginStatus();\n    this.userObj = parserMixin.methods.parseXmlJwt();\n    console.log(\"ID KORISNIKA: \" + this.userObj.id);\n    this.getUserProfileData(this.userObj.id);\n  },\n  methods: {\n    getUserProfileData(id) {\n      try {\n        dataService.getUser(id).then(response => {\n          console.log(\"USER PROFILE: \" + JSON.stringify(response.data));\n          this.profile = response.data;\n          if (this.profile.slike) {\n            console.log(\"BROJ SLIKA: \" + this.profile.slike.length);\n            let tempSlike = [];\n            for (let i = 0; i < this.profile.slike.length; i++) {\n              console.log(\"AAA\");\n              tempSlike.push('data:image/png;base64,' + this.profile.slike[i]);\n            }\n            this.profile.slike = tempSlike;\n            console.log(\"SLIKA POSLE FORMATIRANJA: \" + JSON.stringify(this.profile.slike[0]));\n          }\n        });\n      } catch (error) {\n        console.log(\"GRESKA: \" + error.message);\n      }\n    },\n    updateProfile() {\n      // First name i last name se u paru gledaju da li su popunjeni\n      // Ako su oba prazna u isto vreme ce za oba izbaciti error\n      if (this.profile.korisnickoIme == '') {\n        this.messages.errorUsername = `<h4>Polje korisnicko ime ne moze biti prazno!</h4>`;\n        setTimeout(() => this.messages.errorUsername = '', 5000);\n      } else if (this.profile.ime == '' && this.profile.prezime != '') {\n        his.messages.errorFirstName = `<h4>Polje ime ne moze biti prazno!</h4>`;\n        setTimeout(() => this.messages.errorFirstName = '', 5000);\n      } else if (this.profile.ime != '' && this.profile.prezime == '') {\n        this.messages.errorLastName = `<h4>Polje prezime ne moze biti prazno!</h4>`;\n        setTimeout(() => this.messages.errorLastName = '', 5000);\n      } else if (this.profile.ime == '' && this.profile.prezime == '') {\n        this.messages.errorFirstName = `<h4>Polje ime ne moze biti prazno!</h4>`;\n        this.messages.errorLastName = `<h4>Polje prezime ne moze biti prazno!</h4>`;\n        setTimeout(() => this.messages.errorFirstName = '', 5000);\n        setTimeout(() => this.messages.errorLastName = '', 5000);\n      } else if (this.profile.adresa == '') {\n        this.messages.errorAdresa = `<h4> Polje adresa moze biti prazno!</h4>`;\n        setTimeout(() => this.errorAdresa = '', 5000);\n      }\n\n      //Password check\n      //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\n      else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat === '') {\n        this.messages.errorRepNewPass = `<h4>Morate ponoviti Vasu novu sifru!</h4>`;\n        setTimeout(() => this.messages.errorRepNewPass = '', 55000);\n      }\n      //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\n      else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword === '' && this.changedPassword.newPasswordRepeat !== '') {\n        this.messages.errorNewPass = `<h4>Morate uneti Vasu novu sifru!</h4>`;\n        setTimeout(() => this.messages.errorNewPass = '', 5000);\n      }\n      //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\n      else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword === '' && this.changedPassword.newPasswordRepeat === '') {\n        this.messages.errorNewPass = `<h4>Morate uneti Vasu novu sifru!</h4>`;\n        this.messages.errorRepNewPass = `<h4>Morate ponoviti Vasu novu sifru!</h4>`;\n        setTimeout(() => this.messages.errorNewPass = '', 5000);\n        setTimeout(() => this.messages.errorRepNewPass = '', 5000);\n      }\n      //Ako nije unet old password, a jesu novi ispisuje se error\n      else if (this.changedPassword.oldPassword === '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat !== '') {\n        this.messages.errorOldPass = `<h4>Morate prvo uneti Vasu staru sifru!</h4>`;\n        setTimeout(() => this.messages.errorOldPass = '', 5000);\n      }\n      //Ako su uneta sva 3 passworda, nema errora za prazna polja, ali se proverava validnost samog unosa\n      else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat !== '') {\n        if (this.changedPassword.newPassword !== this.changedPassword.newPasswordRepeat) {\n          this.messages.errorNotEqualNewPassword = `<h4>Vase nove sifre se ne poklapaju! Molimo Vas pokusajte ponovo...</h4>`;\n          setTimeout(() => this.messages.errorNotEqualNewPassword = '', 3000);\n        } else {\n          //ako je stara sifra dobro uneta, a nove se poklapaju,\n          //stara sifra se menja novom.\n          // this.profile.staraSifra = this.changedPassword.oldPassword;\n          // this.profile.novaSifra = this.changedPassword.newPassword;\n          let tempObjekat = {\n            staraSifra: this.changedPassword.oldPassword,\n            novaSifra: this.changedPassword.newPassword\n          };\n          if (tempObjekat.novaSifra === '' || tempObjekat.novaSifra === null) {\n            tempObjekat.novaSifra = '';\n          }\n          if (tempObjekat.staraSifra === '' || tempObjekat.staraSifra === null) {\n            tempObjekat.staraSifra = '';\n          }\n          console.log(\"Korisnik: \" + JSON.stringify(this.profile));\n          let objekat = {\n            korisnikDTO: this.profile,\n            novaSifraDTO: tempObjekat\n          };\n          console.log(\"Objekat koji se salje na bek: \" + JSON.stringify(objekat));\n          dataService.updateUserProfile(objekat).then(Response => {\n            this.messages.successResponse = `<h4>Vas profil je uspesno izmenjen!</h4>`;\n            setTimeout(() => this.messages.successResponse = '', 5000);\n            this.profile = Response.data;\n            setTimeout(() => {\n              this.$router.push(`/home`);\n            }, 5050);\n          }).catch(error => {\n            // && error.response.data.message === \"Wrong password!\"\n            if (error.response.status === 409) {\n              this.messages.errorResponse = `<h4>Vaša stara sifra je netačna! Molimo Vas pokušajte ponovo...</h4>`;\n              setTimeout(() => this.messages.errorResponse = '', 5000);\n            } else if (error.response.status === 500 || error.response.status === 404) {\n              this.messages.errorResponse = `<h4>Imali smo nekih problema na serveru,  molimo Vas pokušajte ponovo kasnije!</h4>`;\n              setTimeout(() => this.messages.errorResponse = '', 5000);\n            }\n          });\n        }\n      } else {\n        let tempObjekat = {\n          staraSifra: '',\n          novaSifra: ''\n        };\n        let objekat = {\n          korisnikDTO: this.profile,\n          novaSifraDTO: tempObjekat\n        };\n        dataService.updateUserProfile(objekat).then(response => {\n          this.messages.successResponse = `<h4>Vas profil je uspesno izmenjen!</h4>`;\n          setTimeout(() => this.messages.successResponse = '', 5000);\n          console.log(response.data);\n          this.profile = response.data;\n        }).catch(error => {\n          if (error.response.status === 500 || error.response.status === 404) {\n            this.messages.errorResponse = `<h4>Imali smo nekih problema na serveru, molimo Vas pokušajte kasnije!</h4>`;\n            setTimeout(() => this.messages.errorResponse = '', 5000);\n          }\n        });\n      }\n    }\n  },\n  components: {\n    datepicker: VueDatePicker\n  }\n};","map":{"version":3,"mappings":"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","names":["dataService","VueDatePicker","parserMixin","data","btnEnabled","profile","ownerId","changedPassword","oldPassword","newPassword","newPasswordRepeat","messages","errorUsername","errorFirstName","errorLastName","errorAdresa","errorOldPass","errorNewPass","errorRepNewPass","errorNotEqualOldPassword","errorNotEqualNewPassword","errorResponse","successResponse","userObj","created","methods","checkLoginStatus","parseXmlJwt","console","log","id","getUserProfileData","getUser","then","response","JSON","stringify","slike","length","tempSlike","i","push","error","message","updateProfile","korisnickoIme","setTimeout","ime","prezime","his","adresa","tempObjekat","staraSifra","novaSifra","objekat","korisnikDTO","novaSifraDTO","updateUserProfile","Response","$router","catch","status","components","datepicker"],"sourceRoot":"","sources":["C:\\Users\\SNSBOT\\Desktop\\XML-2023[PROJEKAT]\\APP2-front\\planetickets\\src\\overviews\\EditProfile.vue"],"sourcesContent":["<template>\r\n   <div id=\"reg-profile-update\" style=\"margin-bottom:200px;\">\r\n        <div id='main'>\r\n\t\t\t<div class=\"container\" id='page-title'>\r\n\t\t\t    <h1 style=\"margin-top:10px;color:#1E90FF;\">Izmena profila <span id='titleEffect'>{{this.profile.tipKorisnika}}</span></h1>\r\n\t\t\t    <hr style='background:#1E90FF;height:1px;'>\r\n\t\t\t</div>\r\n            <div class=\"container\">\r\n                <fieldset class=\"form-group\">\r\n\t\t\t\t\t<label><font color=\"#1E90FF\">Email</font></label>\r\n\t\t\t\t\t<input type=\"text\" class=\"form-control\" v-model=\"profile.email\" disabled />\r\n\t\t\t\t</fieldset>\r\n                <div v-if='messages.errorUsername' id='testError' class=\"alert alert-danger\" v-html=\"messages.errorUsername\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Korisnicko ime</font></label>\r\n                    <input type=\"text\" class=\"form-control\" v-model=\"profile.username\"  disabled/>\r\n                </fieldset>\r\n                <div v-if='messages.errorFirstName' id='testError' class=\"alert alert-danger\" v-html=\"messages.errorFirstName\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Ime</font></label>\r\n                    <input type=\"text\" class=\"form-control\" v-model=\"profile.ime\" />\r\n                </fieldset>\r\n                <div v-if='messages.errorLastName' class=\"alert alert-danger\" v-html=\"messages.errorLastName\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Prezime</font></label>\r\n                    <input type=\"text\" class=\"form-control\" v-model=\"profile.prezime\" />\r\n                </fieldset>\r\n                <div style=\"margin-top:20px\" v-if='messages.errorAdresa' class=\"alert alert-danger\" v-html=\"messages.errorAdresa\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Adresa</font></label>\r\n                    <input type=\"text\" class=\"form-control\" v-model=\"profile.adresa.adresa\" />\r\n                </fieldset>\r\n                <!-- <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Datum Rodjenja</font></label>\r\n                    <input type=\"text\" class=\"form-control\" v-model=\"profile.datumRodjenja\" disabled/>\r\n                </fieldset> -->\r\n\r\n                <hr>\r\n                \r\n                <h4>Promena lozinke</h4>\r\n                <hr>\r\n                <div v-if='messages.errorNotEqualOldPassword' class=\"alert alert-danger\" v-html=\"messages.errorNotEqualOldPassword\"></div>\r\n                <div v-if='messages.errorOldPass' class=\"alert alert-danger\" v-html=\"messages.errorOldPass\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Stara lozinka</font></label>\r\n                    <input type=\"password\" class=\"form-control\" v-model=\"changedPassword.oldPassword\" placeholder=\"Unesite staru loznku...\" />\r\n                </fieldset>\r\n                <div v-if='messages.errorNewPass' class=\"alert alert-danger\" v-html=\"messages.errorNewPass\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Nova lozinka</font></label>\r\n                    <input type=\"password\" class=\"form-control\" v-model=\"changedPassword.newPassword\" placeholder=\"Unesite novu loznku...\" />\r\n                </fieldset>\r\n                <div v-if='messages.errorNotEqualNewPassword' class=\"alert alert-danger\" v-html=\"messages.errorNotEqualNewPassword\"></div>\r\n                <div v-if='messages.errorRepNewPass' class=\"alert alert-danger\" v-html=\"messages.errorRepNewPass\"></div>\r\n                <fieldset class=\"form-group\">\r\n                    <label><font color=\"#1E90FF\">Ponovite novu lozinku</font></label>\r\n                    <input type=\"password\" class=\"form-control\" v-model=\"changedPassword.newPasswordRepeat\" placeholder=\"Ponovite novu loznku...\"  />\r\n                </fieldset>\r\n                <button style=\"margin-top:20px;\" :disabled='btnEnabled' type=\"button\" class=\"btn btn-lg btn-success\" v-on:click='updateProfile()'> Potvrdi </button>\r\n                \r\n                <div v-if='messages.errorResponse' class=\"alert alert-danger\" v-html=\"messages.errorResponse\"></div>\r\n                <div v-if='messages.successResponse' class=\"alert alert-success\" v-html=\"messages.successResponse\"></div>\r\n            </div>\r\n                \r\n                \r\n        </div>\r\n   </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport dataService from '../services/dataService';\r\nimport VueDatePicker from '@vuepic/vue-datepicker';\r\nimport parserMixin from '@/mixins/mixin'\r\n\r\n    export default{\r\n        data(){\r\n            return{\r\n                btnEnabled:false,\r\n                profile: {\r\n                },\r\n                ownerId : '',\r\n\t\t\t    changedPassword: {\r\n                    oldPassword: '',\r\n                    newPassword: '',\r\n                    newPasswordRepeat: '',\r\n                },\r\n                messages:{\r\n                    errorUsername:'',\r\n                    errorFirstName: '',\r\n                    errorLastName: '',\r\n                    errorAdresa:'',\r\n                    errorOldPass: '',\r\n                    errorNewPass: '',\r\n                    errorRepNewPass: '',\r\n                    errorNotEqualOldPassword: '',\r\n                    errorNotEqualNewPassword: '',\r\n                    errorResponse: '',\r\n                    successResponse: '',\r\n                },\r\n                userObj:{\r\n\r\n                }\r\n            }\r\n        },\r\n        created(){\r\n            parserMixin.methods.checkLoginStatus();\r\n            this.userObj = parserMixin.methods.parseXmlJwt();\r\n            console.log(\"ID KORISNIKA: \" + this.userObj.id);\r\n            this.getUserProfileData(this.userObj.id);\r\n        },\r\n        methods:{\r\n            getUserProfileData(id){\r\n                try{\r\n                    dataService.getUser(id).then(response => {\r\n                        console.log(\"USER PROFILE: \" + JSON.stringify(response.data));\r\n                        this.profile = response.data;\r\n                        if(this.profile.slike){\r\n                            console.log(\"BROJ SLIKA: \" + this.profile.slike.length);\r\n                            let tempSlike = [];\r\n                            for(let i = 0; i < this.profile.slike.length; i++){\r\n                                console.log(\"AAA\")\r\n                                tempSlike.push('data:image/png;base64,' + this.profile.slike[i]);\r\n                            }\r\n                            this.profile.slike = tempSlike;\r\n                            console.log(\"SLIKA POSLE FORMATIRANJA: \" + JSON.stringify(this.profile.slike[0]))\r\n                        }\r\n                    });\r\n                }catch(error){\r\n                    console.log(\"GRESKA: \" + error.message);\r\n                }\r\n            },\r\n            updateProfile(){\r\n                 // First name i last name se u paru gledaju da li su popunjeni\r\n                // Ako su oba prazna u isto vreme ce za oba izbaciti error\r\n                if (this.profile.korisnickoIme == '') {\r\n                    this.messages.errorUsername = `<h4>Polje korisnicko ime ne moze biti prazno!</h4>`;\r\n                    setTimeout(() => this.messages.errorUsername = '', 5000);\r\n                }\r\n                else if (this.profile.ime == '' && this.profile.prezime != '') {\r\n                    his.messages.errorFirstName = `<h4>Polje ime ne moze biti prazno!</h4>`;\r\n                    setTimeout(() => this.messages.errorFirstName = '', 5000);\r\n                }\r\n                else if (this.profile.ime != '' && this.profile.prezime == '') {\r\n                    this.messages.errorLastName = `<h4>Polje prezime ne moze biti prazno!</h4>`;\r\n                    setTimeout(() => this.messages.errorLastName = '', 5000);\r\n                }\r\n                else if (this.profile.ime == '' && this.profile.prezime == '') {\r\n                    this.messages.errorFirstName = `<h4>Polje ime ne moze biti prazno!</h4>`;\r\n                    this.messages.errorLastName = `<h4>Polje prezime ne moze biti prazno!</h4>`;\r\n                    setTimeout(() => this.messages.errorFirstName = '', 5000);\r\n                    setTimeout(() => this.messages.errorLastName = '', 5000);\r\n                }\r\n                else if (this.profile.adresa == '') {\r\n                    this.messages.errorAdresa = `<h4> Polje adresa moze biti prazno!</h4>`;\r\n                    setTimeout(() => this.errorAdresa = '', 5000);\r\n                }\r\n\r\n                 //Password check\r\n                //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\r\n                else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat === '') {\r\n                    this.messages.errorRepNewPass = `<h4>Morate ponoviti Vasu novu sifru!</h4>`;\r\n                    setTimeout(() => this.messages.errorRepNewPass = '', 55000);\r\n                }\r\n                //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\r\n                else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword === '' && this.changedPassword.newPasswordRepeat !== '') {\r\n                    this.messages.errorNewPass = `<h4>Morate uneti Vasu novu sifru!</h4>`;\r\n                    setTimeout(() => this.messages.errorNewPass = '', 5000);\r\n                }\r\n                //Ako je unet old password, a nije uneto jedno od polja newPassword ili newPassword reapeat unosi se error\r\n                else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword === '' && this.changedPassword.newPasswordRepeat === '') {\r\n                    this.messages.errorNewPass = `<h4>Morate uneti Vasu novu sifru!</h4>`;\r\n                    this.messages.errorRepNewPass = `<h4>Morate ponoviti Vasu novu sifru!</h4>`;\r\n                    setTimeout(() => this.messages.errorNewPass = '', 5000);\r\n                    setTimeout(() => this.messages.errorRepNewPass = '', 5000);\r\n                }\r\n                //Ako nije unet old password, a jesu novi ispisuje se error\r\n                else if (this.changedPassword.oldPassword === '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat !== '') {\r\n                    this.messages.errorOldPass = `<h4>Morate prvo uneti Vasu staru sifru!</h4>`;\r\n                    setTimeout(() => this.messages.errorOldPass = '', 5000);\r\n                }\r\n                 //Ako su uneta sva 3 passworda, nema errora za prazna polja, ali se proverava validnost samog unosa\r\n                else if (this.changedPassword.oldPassword !== '' && this.changedPassword.newPassword !== '' && this.changedPassword.newPasswordRepeat !== '') {\r\n                    if (this.changedPassword.newPassword !== this.changedPassword.newPasswordRepeat) {\r\n                        this.messages.errorNotEqualNewPassword = `<h4>Vase nove sifre se ne poklapaju! Molimo Vas pokusajte ponovo...</h4>`;\r\n                        setTimeout(() => this.messages.errorNotEqualNewPassword = '', 3000);\r\n                    }\r\n                    else {\r\n                        //ako je stara sifra dobro uneta, a nove se poklapaju,\r\n                        //stara sifra se menja novom.\r\n                        // this.profile.staraSifra = this.changedPassword.oldPassword;\r\n                        // this.profile.novaSifra = this.changedPassword.newPassword;\r\n                        let tempObjekat = {\r\n                            staraSifra: this.changedPassword.oldPassword,\r\n                            novaSifra: this.changedPassword.newPassword,\r\n                        }\r\n                        if(tempObjekat.novaSifra === '' || tempObjekat.novaSifra === null){\r\n                            tempObjekat.novaSifra='';\r\n                        }\r\n                        if(tempObjekat.staraSifra === '' || tempObjekat.staraSifra === null){\r\n                            tempObjekat.staraSifra='';\r\n                        }\r\n                        console.log(\"Korisnik: \" + JSON.stringify(this.profile));\r\n                        let objekat = {\r\n                            korisnikDTO: this.profile,\r\n                            novaSifraDTO: tempObjekat\r\n                        }\r\n                        console.log(\"Objekat koji se salje na bek: \" + JSON.stringify(objekat));\r\n                        dataService.updateUserProfile(objekat).then(Response => {\r\n                            this.messages.successResponse = `<h4>Vas profil je uspesno izmenjen!</h4>`;\r\n                            setTimeout(() => this.messages.successResponse = '', 5000);\r\n                            this.profile = Response.data;\r\n                            setTimeout(() => { this.$router.push(`/home`)}, 5050);\r\n                        })\r\n                        .catch(error=>{\r\n                            // && error.response.data.message === \"Wrong password!\"\r\n                            if(error.response.status === 409 ){\r\n                                this.messages.errorResponse = `<h4>Vaša stara sifra je netačna! Molimo Vas pokušajte ponovo...</h4>`;\r\n                                setTimeout(()=>this.messages.errorResponse='', 5000);\r\n                            }\r\n                            else if (error.response.status === 500 || error.response.status === 404) {\r\n                                this.messages.errorResponse = `<h4>Imali smo nekih problema na serveru,  molimo Vas pokušajte ponovo kasnije!</h4>`;\r\n                                setTimeout(() => this.messages.errorResponse = '', 5000);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                else{\r\n                    let tempObjekat = {\r\n                            staraSifra: '',\r\n                            novaSifra: '',\r\n                        }\r\n                    let objekat = {\r\n                            korisnikDTO: this.profile,\r\n                            novaSifraDTO: tempObjekat\r\n                    }\r\n                    dataService.updateUserProfile(objekat).then(response => {\r\n                        this.messages.successResponse = `<h4>Vas profil je uspesno izmenjen!</h4>`;\r\n                        setTimeout(() => this.messages.successResponse = '', 5000);\r\n                        console.log(response.data)\r\n                        this.profile = response.data;\r\n                    })\r\n                    .catch(error => {\r\n                        if (error.response.status === 500 || error.response.status === 404) {\r\n                            this.messages.errorResponse = `<h4>Imali smo nekih problema na serveru, molimo Vas pokušajte kasnije!</h4>`;\r\n                            setTimeout(() => this.messages.errorResponse = '', 5000);\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n        },\r\n        components:{\r\n            datepicker:VueDatePicker,\r\n        }\r\n        \r\n    }\r\n    \r\n</script>\r\n\r\n<style scoped>\r\n\r\n#titleEffect{\r\n  color:#1E90FF;\r\n  font-weight: bold;\r\n}\r\n\r\n#admin-profile-update .one-forth{\r\n  width:24%;\r\n  padding:10px;\r\n  margin-bottom:15px\r\n}\r\n\r\n#admin-profile-update label{\r\n    color:#35424a;\r\n    display: block;\r\n    margin: 20px 0 10px;\r\n    font-size: 20px;\r\n    font-weight: bold;\r\n}\r\n\r\n.header5{\r\n    color:#1E90FF;\r\n    font-weight: bold;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}